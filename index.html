<!DOCTYPE html>

<html lang="zh">
<head>
<meta charset="utf-8"/>
<title>ä¸€ç›´åœ¨æƒ³ä½ </title>
<meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport"/>
<style>
    :root {
      --color-main: #4A0A8A;
      --color-main-grad: #6A0DAD;
      --color-deep-purple: #2D0047;
      --color-dark-blue: #0A0028;
      --color-cyan: #00ffff;
      --color-white: #ffffff;
      --color-pink: #ff6b9d;
      --color-shadow1: #00ffff;
      --color-shadow2: #6a0dad;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      min-height: 100vh;
      min-width: 100vw;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      background: linear-gradient(135deg, var(--color-dark-blue) 0%, var(--color-deep-purple) 40%, var(--color-main) 80%, var(--color-main-grad) 100%);
      font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "STKaiti", "Segoe UI", Arial, cursive, sans-serif;
      color: var(--color-white);
    }

    body {
      position: relative;
      overflow: hidden;
      overscroll-behavior: none;
    }

    /* èƒŒæ™¯å…ƒç´  */
    #bgCanvas, #particleCanvas {
      position: fixed;
      left: 0; 
      top: 0; 
      z-index: 0;
      width: 100vw !important;
      height: 100vh !important;
      display: block;
    }

    .stars-background {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      background: 
        radial-gradient(2px 2px at 20px 30px, #eee, transparent),
        radial-gradient(2px 2px at 40px 70px, #fff, transparent),
        radial-gradient(1px 1px at 90px 40px, #fff, transparent),
        radial-gradient(1px 1px at 130px 80px, #fff, transparent),
        radial-gradient(2px 2px at 160px 30px, #ddd, transparent);
      background-repeat: repeat;
      background-size: 200px 100px;
      opacity: 0.3;
      animation: twinkle 4s infinite alternate;
    }
    
    @keyframes twinkle {
      0%, 100% { opacity: 0.2; }
      50% { opacity: 0.4; }
    }

    /* ä¸»è¦å†…å®¹åŒºåŸŸ */
    .main-content {
      position: absolute;
      left: 50%; 
      top: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      max-width: 800px;
      z-index: 3;
      text-align: center;
      user-select: none;
    }

    /* å¯ç‚¹å‡»çš„æ ‡é¢˜ */
    .love-saying {
      font-size: 4.5em;
      font-weight: bold;
      color: var(--color-pink);
      letter-spacing: .16em;
      padding-bottom: .15em;
      text-shadow:
        0 0 30px var(--color-shadow1),
        0 0 25px var(--color-shadow2),
        2px 3px 2px #0005;
      animation: romancePulse 2.8s infinite cubic-bezier(.77,0,.17,1);
      background: linear-gradient(90deg, var(--color-pink) 10%, var(--color-cyan) 90%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 1em;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .love-saying:hover {
      transform: scale(1.05);
    }
    
    @keyframes romancePulse {
      0% { transform:translateY(0) scale(1);}
      45%{ transform:translateY(-12px) scale(1.12);}
      100%{transform:translateY(0) scale(1);}
    }

    /* å€’è®¡æ—¶æ ·å¼ - æ•°å­—å­—ä½“å¤§å°é€’å¢ */
    .love-time {
      padding: 1.5em 0.8em;
      border-radius: 20px;
      background: rgba(255, 255, 255, 0.08);
      box-shadow: 
        0 0 40px 6px rgba(0, 255, 255, 0.25) inset,
        0 0 60px 4px rgba(255, 107, 157, 0.3);
      mix-blend-mode: normal;
      transition: all .3s;
      animation: floatText 4.8s ease-in-out infinite alternate;
      display: block;
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(15px);
      border: 3px solid rgba(255, 255, 255, 0.2);
      width: 100%;
      box-sizing: border-box;
      margin-bottom: 2em;
      pointer-events: none;
    }
    
    .time-line {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 0.5em 0;
      line-height: 1.2;
    }
    
    .time-label {
      font-size: 1.2em;
      font-weight: 600;
      color: var(--color-white);
      text-shadow: 0 0 10px var(--color-cyan);
      margin-right: 0.5em;
    }
    
    /* æ•°å­—å­—ä½“å¤§å°é€’å¢ */
    .time-value {
      font-weight: 800;
      color: var(--color-cyan);
      text-shadow: 0 0 15px var(--color-cyan);
    }
    
    .days-value {
      font-size: 4.5em; /* æœ€å¤§ */
    }
    
    .hours-value {
      font-size: 3em;
    }
    
    .minutes-value {
      font-size: 3em;
    }
    
    .seconds-value {
      font-size: 2em;
    }
    
    .milliseconds-value {
      font-size: 1.5em; /* æœ€å° */
    }

    @keyframes floatText {
      0%   { transform:translateY(0);}
      40%  { transform:translateY(-6px);}
      100% { transform:translateY(0);}
    }

    /* å¤§çˆ±å¿ƒæ ·å¼ - å¯ç‚¹å‡» */
    .heart-container {
      position: relative;
      width: 100%;
      height: 180px;
      display: flex;
      justify-content: center;
      align-items: center;
      margin-top: 0.5em;
      cursor: pointer;
    }
    
    .heart {
      position: absolute;
      width: 140px;
      height: 126px;
      animation: heartbeat 1.2s infinite ease-in-out;
      filter: drop-shadow(0 0 25px rgba(255, 107, 157, 0.9));
      z-index: 2;
      transform-origin: center;
      transition: all 0.3s;
    }
    
    .heart:hover {
      transform: scale(1.1);
    }
    
    /* ä½¿ç”¨SVGæ–¹å¼åˆ›å»ºçˆ±å¿ƒï¼Œå…¼å®¹æ€§æ›´å¥½ */
    .heart svg {
      width: 100%;
      height: 100%;
      fill: #ff6b9d;
      filter: drop-shadow(0 0 15px rgba(255, 107, 157, 0.8));
    }
    
    @keyframes heartbeat {
      0% {
        transform: scale(1);
      }
      5% {
        transform: scale(1.1);
      }
      10% {
        transform: scale(1.15);
      }
      15% {
        transform: scale(1.2);
      }
      50% {
        transform: scale(1);
      }
      100% {
        transform: scale(1);
      }
    }
    
    .heart-pulse {
      position: absolute;
      width: 180px;
      height: 180px;
      border-radius: 50%;
      background: rgba(255, 107, 157, 0.3);
      animation: pulse 1.2s infinite;
      z-index: 1;
      transform-origin: center;
    }
    
    @keyframes pulse {
      0% {
        transform: scale(0.8);
        opacity: 0.7;
      }
      50% {
        transform: scale(1.2);
        opacity: 0.3;
      }
      100% {
        transform: scale(1.4);
        opacity: 0;
      }
    }

    /* æ‰“å¡ä¾¿ç­¾æŒ‰é’® */
    .note-button {
      position: fixed;
      bottom: 30px;
      right: 30px;
      padding: 12px 24px;
      background: rgba(255, 107, 157, 0.8);
      color: white;
      border: none;
      border-radius: 50px;
      font-size: 1.2em;
      font-weight: bold;
      cursor: pointer;
      z-index: 10;
      box-shadow: 0 0 20px rgba(255, 107, 157, 0.5);
      transition: all 0.3s;
      pointer-events: auto;
    }
    
    .note-button:hover {
      background: rgba(255, 107, 157, 1);
      transform: scale(1.05);
      box-shadow: 0 0 30px rgba(255, 107, 157, 0.7);
    }

    /* ä¾¿ç­¾å¼¹çª— */
    .note-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s;
    }
    
    .note-modal.active {
      opacity: 1;
      pointer-events: auto;
    }
    
    .note-content {
      background: rgba(30, 0, 50, 0.95);
      border-radius: 20px;
      padding: 30px;
      width: 90%;
      max-width: 600px;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 0 50px rgba(255, 107, 157, 0.5);
      border: 2px solid rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
    }
    
    .note-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      padding-bottom: 10px;
    }
    
    .note-title {
      font-size: 1.8em;
      color: var(--color-pink);
      margin: 0;
    }
    
    .close-button {
      background: none;
      border: none;
      color: white;
      font-size: 1.5em;
      cursor: pointer;
      padding: 5px;
    }
    
    .week-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .nav-button {
      background: rgba(255, 107, 157, 0.6);
      border: none;
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .nav-button:hover {
      background: rgba(255, 107, 157, 0.9);
    }
    
    .nav-button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .week-title {
      font-size: 1.2em;
      color: var(--color-cyan);
    }
    
    .note-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    
    .note-item {
      padding: 15px;
      margin-bottom: 10px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      border-left: 4px solid var(--color-pink);
    }
    
    .note-date {
      font-weight: bold;
      color: var(--color-cyan);
      margin-bottom: 5px;
    }
    
    .note-text {
      color: white;
    }

    /* å…¨å±ç‰¹æ•ˆ */
    .fullscreen-effect {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      pointer-events: none;
      z-index: 100;
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .fullscreen-effect.active {
      opacity: 1;
    }
    
    .fullscreen-effect .effect-bg {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle, rgba(255, 107, 157, 0.7) 0%, rgba(106, 13, 173, 0.8) 100%);
      animation: effectBgPulse 3s ease-out forwards;
    }
    
    @keyframes effectBgPulse {
      0% {
        transform: scale(0);
        opacity: 0;
      }
      20% {
        transform: scale(1);
        opacity: 1;
      }
      80% {
        transform: scale(1);
        opacity: 1;
      }
      100% {
        transform: scale(1.2);
        opacity: 0;
      }
    }
    
    .fullscreen-effect .effect-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 4em;
      color: white;
      text-shadow: 0 0 40px rgba(255, 255, 255, 0.9);
      animation: effectTextPulse 3s ease-out forwards;
      z-index: 101;
      text-align: center;
      font-weight: bold;
      white-space: pre-line;
      line-height: 1.4;
    }
    
    @keyframes effectTextPulse {
      0% {
        transform: translate(-50%, -50%) scale(0);
        opacity: 0;
      }
      30% {
        transform: translate(-50%, -50%) scale(1.2);
        opacity: 1;
      }
      50% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
      }
      70% {
        transform: translate(-50%, -50%) scale(1.1);
        opacity: 1;
      }
      100% {
        transform: translate(-50%, -50%) scale(1.2);
        opacity: 0;
      }
    }

    /* å“åº”å¼è®¾è®¡ - ä¼˜åŒ–ç§»åŠ¨ç«¯æ˜¾ç¤º */
    @media (max-width: 768px) {
      .main-content {
        width: 95%;
      }
      
      .love-saying {
        font-size: 3em;
      }
      
      .love-time {
        padding: 1em 0.5em;
      }
      
      .days-value { font-size: 2.8em; }
      .hours-value { font-size: 2.4em; }
      .minutes-value { font-size: 2em; }
      .seconds-value { font-size: 1.6em; }
      .milliseconds-value { font-size: 1.2em; }
      
      /* ç§»åŠ¨ç«¯çˆ±å¿ƒå°ºå¯¸è°ƒæ•´ */
      .heart {
        width: 120px;
        height: 108px;
      }
      
      .heart-pulse {
        width: 150px;
        height: 150px;
      }
      
      .fullscreen-effect .effect-text {
        font-size: 3em;
      }
      
      .note-button {
        bottom: 20px;
        right: 20px;
        font-size: 1.1em;
        padding: 10px 20px;
      }
    }

    @media (max-width: 480px) {
      .love-saying {
        font-size: 2em;
      }
      
      .days-value { font-size: 2.2em; }
      .hours-value { font-size: 1.9em; }
      .minutes-value { font-size: 1.6em; }
      .seconds-value { font-size: 1.3em; }
      .milliseconds-value { font-size: 1em; }
      
      .time-label {
        font-size: 1em;
      }
      
      /* å°å±å¹•çˆ±å¿ƒå°ºå¯¸è°ƒæ•´ */
      .heart {
        width: 100px;
        height: 90px;
      }
      
      .heart-pulse {
        width: 130px;
        height: 130px;
      }
      
      .fullscreen-effect .effect-text {
        font-size: 2em;
      }
      
      .note-button {
        bottom: 10px;
        right: 10px;
        font-size: 0.9em;
        padding: 6px 12px;
      }
      
      .note-content {
        padding: 20px;
      }
    }

    @media (max-width: 360px) {
      /* è¶…å°å±å¹•è¿›ä¸€æ­¥è°ƒæ•´ */
      .heart {
        width: 80px;
        height: 72px;
      }
      
      .heart-pulse {
        width: 110px;
        height: 110px;
      }
      
      .love-saying {
        font-size: 1.8em;
      }
    }

    /* éšè—æ»šåŠ¨æ¡ */
    ::-webkit-scrollbar {
      display: none;
    }
  </style>
</head>
<body>
<!-- æ·±é‚ƒæ˜Ÿç©ºèƒŒæ™¯ -->
<div class="stars-background"></div>
<!-- èƒŒæ™¯Canvas -->
<canvas id="bgCanvas"></canvas>
<canvas id="particleCanvas"></canvas>
<!-- å…¨å±ç‰¹æ•ˆ -->
<div class="fullscreen-effect" id="fullscreenEffect">
<div class="effect-bg"></div>
<div class="effect-text" id="effectText">ğŸ’–</div>
</div>
<!-- æ‰“å¡ä¾¿ç­¾å¼¹çª— -->
<div class="note-modal" id="noteModal">
<div class="note-content">
<div class="note-header">
<h2 class="note-title">æƒ³ä½ çš„æ¯ä¸€å¤© ğŸ’Œ</h2>
<button class="close-button" id="closeNote">âœ•</button>
</div>
<div class="week-navigation">
<button class="nav-button" id="prevWeek">ä¸Šä¸€å‘¨</button>
<div class="week-title" id="weekTitle">ç¬¬1å‘¨</div>
<button class="nav-button" id="nextWeek">ä¸‹ä¸€å‘¨</button>
</div>
<ul class="note-list" id="noteList">
<!-- ä¾¿ç­¾å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
</ul>
</div>
</div>
<!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
<div class="main-content">
<!-- å¯ç‚¹å‡»çš„æ ‡é¢˜ -->
<div class="love-saying" id="loveSaying">TaiTugouåœ¨æƒ³è€å©†</div>
<div class="love-time" id="loveTime">
<div class="time-line">
<span class="time-label">æƒ³ä½ äº†</span>
</div>
<div class="time-line" style="height: 0.5em;"></div> <!-- é—´éš”è¡Œ -->
<div class="time-line">
<span class="time-value days-value" id="days">0</span>
<span class="time-label">å¤©</span>
</div>
<div class="time-line">
<span class="time-value hours-value" id="hours">00</span>
<span class="time-label">å°æ—¶</span>
</div>
<div class="time-line">
<span class="time-value minutes-value" id="minutes">00</span>
<span class="time-label">åˆ†é’Ÿ</span>
</div>
<div class="time-line">
<span class="time-value seconds-value" id="seconds">00</span>
<span class="time-label">ç§’</span>
</div>
<div class="time-line">
<span class="time-value milliseconds-value" id="milliseconds">000</span>
<span class="time-label">æ¯«ç§’</span>
</div>
</div>
<!-- å¯ç‚¹å‡»çš„çˆ±å¿ƒ -->
<div class="heart-container" id="heartContainer">
<div class="heart-pulse"></div>
<div class="heart">
<!-- ä½¿ç”¨SVGçˆ±å¿ƒï¼Œå…¼å®¹æ€§æ›´å¥½ -->
<svg viewbox="0 0 32 29.6">
<path d="M23.6,0c-3.4,0-6.3,2.7-7.6,5.6C14.7,2.7,11.8,0,8.4,0C3.8,0,0,3.8,0,8.4c0,9.4,9.5,11.9,16,21.2
          c6.1-9.3,16-12.1,16-21.2C32,3.8,28.2,0,23.6,0z"></path>
</svg>
</div>
</div>
</div>
<!-- æ‰“å¡ä¾¿ç­¾æŒ‰é’® -->
<button class="note-button" id="noteButton">æ‰“å¡ä¾¿ç­¾ ğŸ’</button>
<script>
    // é…ç½®å‚æ•°
    const CONFIG = {
      startDate: "2025-10-18T13:28:07",
    };

    // æ¯å¤©ä¸åŒçš„ç‰¹æ®Šæ¶ˆæ¯ - æ‚¨å¯ä»¥åœ¨è¿™é‡Œä¿®æ”¹
    const dailyMessages = [
      "å‘¨ä¸€ï¼šæ²¡æƒ³åˆ°æ¯å¤©ä¸ä¸€æ ·å§ï¼Œæ–°çš„ä¸€å‘¨å¼€å§‹äº†ï¼Œæ›´åŠ æƒ³ä½ äº†ğŸ’•",
      "å‘¨äºŒï¼šè·ç¦»å‘¨æœ«åˆè¿‘äº†ä¸€å¤©ï¼ŒæœŸå¾…è§åˆ°ä½ âœ¨",
      "å‘¨ä¸‰ï¼šä¸€å‘¨è¿‡åŠï¼Œæ€å¿µå´è¶Šæ¥è¶Šæµ“ğŸŒ¹",
      "å‘¨å››ï¼šå¿«è¦è§åˆ°ä½ äº†ï¼Œå¿ƒæƒ…å¼€å§‹æ¿€åŠ¨ğŸŒŸ",
      "å‘¨äº”ï¼šæ˜å¤©ä¸­åˆå°±èƒ½ç›¸è§äº†ï¼Œæ— æ¯”æœŸå¾…ğŸ’–",
      "å‘¨å…­ï¼šç»ˆäºç­‰åˆ°è¿™ä¸€å¤©ï¼Œå¥½æƒ³é©¬ä¸Šè§åˆ°ä½ ï¼Œä¸­åˆç­‰æˆ‘ğŸ‰",
      "å‘¨æ—¥ï¼šçæƒœå’Œä½ åœ¨ä¸€èµ·çš„æ¯ä¸€åˆ†æ¯ä¸€ç§’ğŸ’"
    ];

    // çŠ¶æ€ç®¡ç†
    const state = {
      currentWeek: 0,
      notes: JSON.parse(localStorage.getItem('loveNotes')) || [],
      effectTimeout: null
    };

    // DOM å…ƒç´ 
    const elements = {
      bgCanvas: document.getElementById('bgCanvas'),
      particleCanvas: document.getElementById('particleCanvas'),
      fullscreenEffect: document.getElementById('fullscreenEffect'),
      effectText: document.getElementById('effectText'),
      loveSaying: document.getElementById('loveSaying'),
      days: document.getElementById('days'),
      hours: document.getElementById('hours'),
      minutes: document.getElementById('minutes'),
      seconds: document.getElementById('seconds'),
      milliseconds: document.getElementById('milliseconds'),
      heartContainer: document.getElementById('heartContainer'),
      noteButton: document.getElementById('noteButton'),
      noteModal: document.getElementById('noteModal'),
      closeNote: document.getElementById('closeNote'),
      noteList: document.getElementById('noteList'),
      prevWeek: document.getElementById('prevWeek'),
      nextWeek: document.getElementById('nextWeek'),
      weekTitle: document.getElementById('weekTitle')
    };

    // åˆå§‹åŒ–
    function init() {
      setupBackground();
      setupParticles();
      setupEventListeners();
      startTimer();
      generateAllNotes();
    }

    // è®¾ç½®èƒŒæ™¯
    function setupBackground() {
      const bgCtx = elements.bgCanvas.getContext('2d');
      
      function resizeBgCanvas() {
        elements.bgCanvas.width = window.innerWidth;
        elements.bgCanvas.height = window.innerHeight;
      }
      
      resizeBgCanvas();
      window.addEventListener('resize', resizeBgCanvas);

      function drawBackground() {
        const w = elements.bgCanvas.width, h = elements.bgCanvas.height;
        
        // æ·±é‚ƒèƒŒæ™¯æ¸å˜
        const gradient = bgCtx.createLinearGradient(0, 0, w, h);
        gradient.addColorStop(0, "#0A0028");
        gradient.addColorStop(0.3, "#2D0047");
        gradient.addColorStop(0.7, "#4A0A8A");
        gradient.addColorStop(1, "#6A0DAD");
        
        bgCtx.fillStyle = gradient;
        bgCtx.fillRect(0, 0, w, h);
        
        requestAnimationFrame(drawBackground);
      }
      
      drawBackground();
    }

    // è®¾ç½®ç²’å­ç³»ç»Ÿ
    function setupParticles() {
      const pCtx = elements.particleCanvas.getContext('2d');
      let dpr = window.devicePixelRatio || 1;
      
      function resizeParticleCanvas() {
        const w = window.innerWidth, h = window.innerHeight;
        elements.particleCanvas.width = w * dpr;
        elements.particleCanvas.height = h * dpr;
        elements.particleCanvas.style.width = w + 'px';
        elements.particleCanvas.style.height = h + 'px';
        pCtx.setTransform(1, 0, 0, 1, 0, 0);
        pCtx.scale(dpr, dpr);
      }
      
      resizeParticleCanvas();
      window.addEventListener('resize', resizeParticleCanvas);
      
      function drawParticles() {
        pCtx.clearRect(0, 0, window.innerWidth, window.innerHeight);
        
        // ç»˜åˆ¶ä¸€ä¸ªå¤§çš„çˆ±å¿ƒè½®å»“
        const centerX = window.innerWidth / 2;
        const centerY = window.innerHeight / 2 - 45;
        const size = Math.min(window.innerWidth, window.innerHeight) * 0.03;
        
        pCtx.beginPath();
        for(let t = 0; t <= 2 * Math.PI; t += 0.01) {
          const x = 16 * Math.pow(Math.sin(t), 3);
          const y = -(13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t));
          pCtx.lineTo(centerX + x * size, centerY + y * size);
        }
        pCtx.closePath();
        pCtx.strokeStyle = 'rgba(255, 107, 157, 0.3)';
        pCtx.lineWidth = 2;
        pCtx.stroke();
        
        requestAnimationFrame(drawParticles);
      }
      
      drawParticles();
    }

    // è®¾ç½®äº‹ä»¶ç›‘å¬
    function setupEventListeners() {
      // ç‚¹å‡»çˆ±å¿ƒæ˜¾ç¤ºå…¨å±ç‰¹æ•ˆ
      elements.heartContainer.addEventListener('click', showHeartEffect);
      elements.heartContainer.addEventListener('touchstart', showHeartEffect, { passive: true });
      
      // ç‚¹å‡»æ ‡é¢˜æ˜¾ç¤ºæ¯æ—¥æ¶ˆæ¯
      elements.loveSaying.addEventListener('click', showDailyMessage);
      elements.loveSaying.addEventListener('touchstart', showDailyMessage, { passive: true });
      
      // ä¾¿ç­¾åŠŸèƒ½
      elements.noteButton.addEventListener('click', openNoteModal);
      elements.closeNote.addEventListener('click', closeNoteModal);
      elements.prevWeek.addEventListener('click', showPrevWeek);
      elements.nextWeek.addEventListener('click', showNextWeek);
      
      // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­
      elements.noteModal.addEventListener('click', (e) => {
        if (e.target === elements.noteModal) {
          closeNoteModal();
        }
      });
    }

    // æ˜¾ç¤ºçˆ±å¿ƒç‰¹æ•ˆ
    let heartClickCount = 0; // è®°å½•ç‚¹å‡»æ¬¡æ•°

function showHeartEffect() {
  heartClickCount++;

  const base = document.getElementById('fullscreenEffect');
  if (!base) return;
  const clone = base.cloneNode(true);
  clone.id = '';
  clone.classList.add('active');

  const textEl = clone.querySelector('.effect-text');
  if (heartClickCount >= 10) {
    if (textEl) textEl.textContent = 'è€å©†ï¼Œç­‰æˆ‘å›å®¶ğŸ˜­';
    heartClickCount = 0; // é‡ç½®è®¡æ•°
  } else {
    if (textEl) textEl.textContent = 'ğŸ’–';
  }

  document.body.appendChild(clone);
  setTimeout(() => {
    try { clone.remove(); } catch (e) {}
  }, 2200);
}



    // æ˜¾ç¤ºæ¯å¤©ä¸åŒçš„æ¶ˆæ¯
    function showDailyMessage() {
  const today = new Date();
  const dayOfWeek = today.getDay();
  const messageIndex = dayOfWeek === 0 ? dailyMessages.length - 1 : dayOfWeek - 1;
  const dailyMessage = dailyMessages[messageIndex] || '';
  const base = document.getElementById('fullscreenEffect');
  if (!base) return;
  const clone = base.cloneNode(true);
  clone.id = '';
  clone.classList.add('active');
  const textEl = clone.querySelector('.effect-text');
  if (textEl) textEl.textContent = dailyMessage;
  document.body.appendChild(clone);
  setTimeout(() => {
    try { clone.remove(); } catch (e) {}
  }, 4200);
}


    // å¯åŠ¨è®¡æ—¶å™¨
    function startTimer() {
      const startTime = new Date(CONFIG.startDate).getTime();
      
      function updateTimer() {
        const now = Date.now();
        const diff = now - startTime;
        
        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((diff % (1000 * 60)) / 1000);
        const milliseconds = diff % 1000;
        
        elements.days.textContent = days;
        elements.hours.textContent = hours.toString().padStart(2, '0');
        elements.minutes.textContent = minutes.toString().padStart(2, '0');
        elements.seconds.textContent = seconds.toString().padStart(2, '0');
        elements.milliseconds.textContent = milliseconds.toString().padStart(3, '0');
        
        requestAnimationFrame(updateTimer);
      }
      
      updateTimer();
    }

    // ä¾¿ç­¾åŠŸèƒ½
    function generateAllNotes() {
      const startDate = new Date(CONFIG.startDate);
      const today = new Date();
      const notes = [];
      
      // ç”Ÿæˆä»å¼€å§‹æ—¥æœŸåˆ°ä»Šå¤©çš„æ‰€æœ‰ä¾¿ç­¾
      let currentDate = new Date(startDate);
      while (currentDate <= today) {
        const year = currentDate.getFullYear();
        const month = currentDate.getMonth() + 1;
        const date = currentDate.getDate();
        const day = currentDate.getDay();
        const dayNames = ['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'];
        
        // è®¡ç®—æƒ³ä½ çš„å¤©æ•°
        const diffTime = Math.abs(currentDate - startDate);
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        
        const dateStr = `${year}å¹´${month}æœˆ${date}æ—¥ æ˜ŸæœŸ${dayNames[day]}`;
        const noteText = `ä»Šå¤©${month}æœˆ${date}æ—¥æ˜ŸæœŸ${dayNames[day]}ï¼Œæƒ³è€å©†çš„ç¬¬${diffDays}å¤©`;
        
        notes.push({
          date: dateStr,
          text: noteText,
          timestamp: currentDate.getTime()
        });
        
        // ä¸‹ä¸€å¤©
        currentDate.setDate(currentDate.getDate() + 1);
      }
      
      state.notes = notes.reverse(); // æœ€æ–°çš„åœ¨å‰é¢
      localStorage.setItem('loveNotes', JSON.stringify(state.notes));
    }

    function openNoteModal() {
      updateWeekDisplay();
      elements.noteModal.classList.add('active');
    }

    function closeNoteModal() {
      elements.noteModal.classList.remove('active');
    }

    function showPrevWeek() {
      if (state.currentWeek > 0) {
        state.currentWeek--;
        updateWeekDisplay();
      }
    }

    function showNextWeek() {
      const totalWeeks = Math.ceil(state.notes.length / 7);
      if (state.currentWeek < totalWeeks - 1) {
        state.currentWeek++;
        updateWeekDisplay();
      }
    }

    function updateWeekDisplay() {
      const startIndex = state.currentWeek * 7;
      const endIndex = startIndex + 7;
      const weekNotes = state.notes.slice(startIndex, endIndex);
      
      // æ›´æ–°å‘¨æ ‡é¢˜
      elements.weekTitle.textContent = `ç¬¬${state.currentWeek + 1}å‘¨`;
      
      // æ›´æ–°å¯¼èˆªæŒ‰é’®çŠ¶æ€
      elements.prevWeek.disabled = state.currentWeek === 0;
      const totalWeeks = Math.ceil(state.notes.length / 7);
      elements.nextWeek.disabled = state.currentWeek >= totalWeeks - 1;
      
      // æ›´æ–°ä¾¿ç­¾åˆ—è¡¨
      elements.noteList.innerHTML = '';
      
      if (weekNotes.length === 0) {
        const emptyItem = document.createElement('li');
        emptyItem.className = 'note-item';
        emptyItem.innerHTML = '<div class="note-text">æš‚æ— è®°å½•</div>';
        elements.noteList.appendChild(emptyItem);
      } else {
        weekNotes.forEach(note => {
          const noteItem = document.createElement('li');
          noteItem.className = 'note-item';
          noteItem.innerHTML = `
            <div class="note-date">${note.date}</div>
            <div class="note-text">${note.text}</div>
          `;
          elements.noteList.appendChild(noteItem);
        });
      }
    }

    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    window.addEventListener('load', init);
  </script>
</body>
</html>
